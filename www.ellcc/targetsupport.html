<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="Content-Type">
  <title>Setting Up Target Support</title>
  <meta content="Richard Pennington" name="author">
</head>
<body>
<table style="text-align: left; width: 100%; height: 100%;" border="0"
 cellpadding="0" cellspacing="0">
  <tbody>
    <tr align="center">
      <th
 style="text-align: center; vertical-align: middle; background-color: rgb(192, 192, 192); height: 135px;"
 colspan="2" rowspan="1">
      <table style="text-align: left; width: 100%;" border="0"
 cellpadding="0" cellspacing="0">
        <tbody>
          <tr>
            <td style="height: 135px; width: 135px;"><img
 style="width: 135px; height: 135px;" alt="ELLCC" src="images/ellcc.png"></td>
            <td style="text-align: center;">
            <h1><a class="mozTocH1" name="mozTocId679816"></a>Setting
Up Target Support</h1>
            </td>
          </tr>
        </tbody>
      </table>
      </th>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(153, 255, 153); width: 135px;"><a
 href="index.html">Home</a><br>
      <a href="news.html">News</a><br>
      <a href="ellcc/libecc/share/doc">Documentation</a><br>
      <a href="installation.html">Installation</a><br>
      <a href="targetsupport.html">Target Support</a><br>
      <a href="wiki">Wiki</a><br>
      <a href="bugzilla">Bug Database</a><br>
      <a href="svn/ellcc">Source Repository</a><br>
      <a href="mailto:rich@pennware.com">Contact</a><br>
      </td>
      <td style="vertical-align: top;">
      <ol id="mozToc">
      </ol>
Setting up target support means building the appropriate libraries to
support cross compilation
of programs using ELLCC. You should have completed the ELLCC <a
 href="installation.html">Installation</a> steps before you try to
setup target support as the <span style="font-family: monospace;">ecc</span>
compiler is required at this point.<br>
      <h2><a class="mozTocH2" name="mozTocId834743"></a>Building the
Run Time Libraries</h2>
The ELLCC C run time library, <span style="font-family: monospace;">libecc</span>,
is
based
on source code from several sources. The C standard library is
based on the NetBSD C library. Support for operations, such as 64 bit
additions and floating point, that a target does not support directly
are provided by <a href="http://compiler-rt.llvm.org/">the LLVM
project's compiler-rt</a>.<br>
      <br>
Now build the libraries:<br>
      <br>
      <div style="margin-left: 40px;"><code>[~/ellcc] main% cd
libecc/obj</code><br>
      <code>[~/ellcc/libecc/obj] main% make install<br>
      </code></div>
      <br>
This will build and install libraries for all the supported processors
and operating systems. The bin directory should look something like
this:<br>
      <br>
      <div style="margin-left: 40px;"><span
 style="font-family: monospace;">[~/ellcc] main% ls bin</span><br>
      <span style="font-family: monospace;">arm-elf-as*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecc-objcopy*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
llvm-extract*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ppc64-linux-ecc@&nbsp;&nbsp; qemu-system-arm*</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">arm-elf-ecc@&nbsp;&nbsp;&nbsp;&nbsp;
ecc-objdump*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
llvm-ld*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ppc64-netbsd-ecc@&nbsp; qemu-system-microblaze*</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">arm-linux-ecc@&nbsp;&nbsp;
ecc-ranlib*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
llvm-link*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ppc-elf-as*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; qemu-system-mips*</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">arm-netbsd-ecc@&nbsp;
ecc-readelf*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
llvm-mc*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ppc-elf-ecc@&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; qemu-system-mipsel*</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">bugpoint*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecc-size*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
llvm-nm*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ppc-linux-ecc@&nbsp;&nbsp;&nbsp;&nbsp; qemu-system-ppc*</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">c-index-test*&nbsp;&nbsp;&nbsp;
ecc-strings*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
llvm-prof*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ppc-netbsd-ecc@&nbsp;&nbsp;&nbsp; qemu-system-ppc64*</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">ecc*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecc-strip*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
llvm-ranlib*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
qemu*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
qemu-system-sparc*</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">ecc++@&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
i386-elf-as*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
llvm-stub*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
qemu-arm*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
qemu-system-x86_64*</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">ecc-addr2line*&nbsp;&nbsp;
i386-elf-ecc@&nbsp;&nbsp;&nbsp;&nbsp;
macho-dump*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
qemu-armeb*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; qemu-x86_64*</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">ecc-ar*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
i386-linux-ecc@&nbsp;&nbsp;
microblaze-elf-as*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
qemu-i386*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sparc-elf-as*</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">ecc-as*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
i386-netbsd-ecc@&nbsp; microblaze-elf-ecc@&nbsp;&nbsp;&nbsp;&nbsp;
qemu-img*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sparc-elf-ecc@</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">ecc-c++filt*&nbsp;&nbsp;&nbsp;&nbsp;
llc*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
microblaze-linux-ecc@&nbsp;&nbsp;
qemu-io*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
tblgen*</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">ecc-elfedit*&nbsp;&nbsp;&nbsp;&nbsp;
lli*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
microblaze-netbsd-ecc@&nbsp; qemu-microblaze*&nbsp;&nbsp; x86_64-elf-as*</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">ecc-embedspu*&nbsp;&nbsp;&nbsp;
llvm-ar*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mips-elf-as*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
qemu-mips*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
x86_64-elf-ecc@</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">ecc-gdb*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
llvm-as*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mips-elf-ecc@&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
qemu-mipsel*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x86_64-linux-ecc@</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">ecc-gdbserver*&nbsp;&nbsp;
llvm-bcanalyzer*&nbsp;
mips-linux-ecc@&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
qemu-nbd*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
x86_64-netbsd-ecc@</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">ecc-gdbtui*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
llvmc*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mips-netbsd-ecc@&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; qemu-ppc*</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">ecc-gprof*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
llvm-config*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
opt*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
qemu-ppc64*</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">ecc-ld*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
llvm-diff*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ppc64-elf-as*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
qemu-ppc64abi32*</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">ecc-nm*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
llvm-dis*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ppc64-elf-ecc@&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
qemu-sparc*</span><span style="font-family: monospace;"></span><br>
      </div>
      <br>
Symbolic links have been added to <span style="font-family: monospace;">ecc</span>
for every processor/operating system for which libraries have been
successfully built. You can use the appropriate symbolic link to run
the compiler and the appropriate include files and libraries will be
used to build your programs.<br>
      <h2>A Quick Sanity Check</h2>
I use the bzip2 program as an initial sanity check for all the
processors. I've modified the Makefile to build bzip2 for each
processor and run it under QEMU. If the make succeeds, you are in
business.<br>
      <br>
      <div style="margin-left: 40px;"><span
 style="font-family: monospace;">[~/ellcc/test] main% cd ..</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">[~/ellcc] main% cd
test/src/bzip2-1.0.6/</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">[~/ellcc/test/src/bzip2-1.0.6]
main%
make</span><br>
      <span style="font-family: monospace;">...</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">[Several builds and runs of
bzip2]</span><br>
      <span style="font-family: monospace;">...</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">If you got this far and the
'cmp's didn't complain, it looks</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">like you're in
business.&nbsp; </span><br style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">To install in
/usr/local/bin, /usr/local/lib, /usr/local/man and </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">/usr/local/include, type</span><br
 style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; make install</span><br
 style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">To install somewhere else,
eg, /xxx/yyy/{bin,lib,man,include}, type </span><br
 style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; make install
PREFIX=/xxx/yyy</span><br style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">If you are (justifiably)
paranoid and want to see what 'make install'</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">is going to do, you can
first do</span><br style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; make -n
install&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
or</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">&nbsp;&nbsp; make -n
install PREFIX=/xxx/yyy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; respectively.</span><br
 style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">The -n instructs make to
show the commands it would execute, but</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">not actually execute them.</span><br
 style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">Instructions for use are in
the preformatted manual page, in the file</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">bzip2.txt.&nbsp; For more
detailed documentation, read the full manual.&nbsp; </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">It is available in
Postscript form (manual.ps), PDF form (manual.pdf),</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">and HTML form (manual.html).</span><br
 style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">You can also do "bzip2
--help" to see some helpful information. </span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">"bzip2 -L" displays the
software license.</span><br style="font-family: monospace;">
      <br style="font-family: monospace;">
      <span style="font-family: monospace;">make[1]: Leaving directory
`/home/rich/ellcc/test/src/bzip2-1.0.6'</span><br
 style="font-family: monospace;">
      <span style="font-family: monospace;">[~/ellcc/test/src/bzip2-1.0.6]
main%</span><br>
      </div>
      <br>
      <span style="font-family: monospace;"></span>Good luck!<br>
      <span style="font-family: monospace;"></span> <span
 style="font-family: monospace;"><br>
      </span> <code></code><code></code><span
 style="font-weight: bold;"></span><span style="font-weight: bold;"></span><span
 style="font-weight: bold;"></span></td>
    </tr>
  </tbody>
</table>
<br>
</body>
</html>
